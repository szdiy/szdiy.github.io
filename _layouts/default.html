<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}" media="screen" type="text/css">
    <link rel="stylesheet" href="{{ '/assets/css/print.css' | relative_url }}" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>{{ site.title | default: site.github.repository_name }}</title>

    <script>
      (function() {
        const THEME_STORAGE_KEY = 'szdiy-theme';
        
        // 获取当前主题
        function getCurrentTheme() {
          // 优先从 localStorage 获取用户设置
          const savedTheme = localStorage.getItem(THEME_STORAGE_KEY);
          if (savedTheme) {
            return savedTheme;
          }
          
          // 其次从系统偏好获取
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark';
          }

          return 'light';
        }

        const theme = getCurrentTheme();
        document.documentElement.setAttribute('data-theme', theme);
        
        // 添加一个类来标记主题已设置，用于 CSS 优化
        document.documentElement.classList.add('theme-loaded');
      })();
    </script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K288G7P9');</script>
<!-- End Google Tag Manager -->
  </head>

  <body>
    <!-- 跳过链接 -->
    <a href="#main-content" class="skip-link">❤ To Main Content 跳转到主要内容</a>

    <div id="content-wrapper">

        {% include sidebar.html %}

        <main id="main-content">
          {{ content }}
        </main>

    </div>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K288G7P9"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<!-- 主题切换脚本 -->
<script src="{{ '/assets/js/theme-switcher.js' | relative_url }}"></script>

<!-- 奖项行自动识别脚本 -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // 查找所有表格，找到含有"奖项"表头的表格
    document.querySelectorAll('table').forEach(function(table) {
      var headers = table.querySelectorAll('th');
      var awardColIndex = -1;
      headers.forEach(function(th, index) {
        if (th.textContent.trim() === '奖项') {
          awardColIndex = index;
        }
      });
      if (awardColIndex === -1) return;

      // 遍历表格行，找到奖项列有内容的行
      table.querySelectorAll('tbody tr, tr').forEach(function(tr) {
        var cells = tr.querySelectorAll('td');
        if (cells.length > awardColIndex) {
          var awardCell = cells[awardColIndex];
          if (awardCell && awardCell.textContent.trim() !== '') {
            tr.classList.add('award-row');
            awardCell.classList.add('award-cell');
            
            // 检测是否为年度最受欢迎分享奖
            if (awardCell.textContent.includes('年度最受欢迎')) {
              tr.classList.add('top-award-row');
              awardCell.classList.add('top-award-cell');
            }
          }
        }
      });
    });
  });
</script>
  </body>
</html>
